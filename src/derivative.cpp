#include "derivative.h"

#define a1 0.79926643
#define a2 -0.18941314
#define a3 0.02651995
#define b1 1.5
#define b2 -0.6/4.0
#define b3 0.1/9.0


ptype Dx(ptype *A, int x, int y, int z)
{
	ptype dA = 	a1*(A[Iw(1,0,0)] - A[Iw(-1,0,0)]) + a2*(A[Iw(2,0,0)] - A[Iw(-2,0,0)]) + a3*(A[Iw(3,0,0)] - A[Iw(-3,0,0)]);
	return dA;
}

ptype Dy(ptype *A, int x, int y, int z)
{
	ptype dA = 	a1*(A[Iw(0,1,0)] - A[Iw(0,-1,0)]) + a2*(A[Iw(0,2,0)] - A[Iw(0,-2,0)]) + a3*(A[Iw(0,3,0)] - A[Iw(0,-3,0)]);
	return dA;
}

ptype Dz(ptype *A, int x, int y, int z)
{
	ptype dA = 	a1*(A[Iw(0,0,1)] - A[Iw(0,0,-1)]) + a2*(A[Iw(0,0,2)] - A[Iw(0,0,-2)]) + a3*(A[Iw(0,0,3)] - A[Iw(0,0,-3)]);
	return dA;
}

ptype Dxx(ptype *A, int x, int y, int z)
{
	ptype dA = 	b1*(A[Iw(1,0,0)] + A[Iw(-1,0,0)] - 2*A[Iw(0,0,0)]) + b2*(A[Iw(2,0,0)] + A[Iw(-2,0,0)] - 2*A[Iw(0,0,0)]) + b3*(A[Iw(3,0,0)] + A[Iw(-3,0,0)] - 2*A[Iw(0,0,0)]);
	return dA;
}

ptype Dyy(ptype *A, int x, int y, int z)
{
	ptype dA = 	b1*(A[Iw(0,1,0)] + A[Iw(0,-1,0)] - 2*A[Iw(0,0,0)]) + b2*(A[Iw(0,2,0)] + A[Iw(0,-2,0)] - 2*A[Iw(0,0,0)]) + b3*(A[Iw(0,3,0)] + A[Iw(0,-3,0)] - 2*A[Iw(0,0,0)]);
	return dA;
}

ptype Dzz(ptype *A, int x, int y, int z)
{
	ptype dA = 	b1*(A[Iw(0,0,1)] + A[Iw(0,0,-1)] - 2*A[Iw(0,0,0)]) + b2*(A[Iw(0,0,2)] + A[Iw(0,0,-2)] - 2*A[Iw(0,0,0)]) + b3*(A[Iw(0,0,3)] + A[Iw(0,0,-3)] - 2*A[Iw(0,0,0)]);
	return dA;
}

ptype DABC(ptype *A, ptype *Bx, ptype *By, ptype *Bz, ptype*C, int x, int y, int z)
{
	ptype D = 2.0*(
				( 
				a1*0.125*(A[Iw( 0,0,0)] + A[Iw( 1,0,0)])* (Bx[Iw( 0,0,0)] + Bx[Iw( 1,0,0)])*(C[Iw( 0,0,0)] + C[Iw( 1,0,0)]) + 
				a2*0.125*(A[Iw( 0,0,0)] + A[Iw( 2,0,0)])* (Bx[Iw( 0,0,0)] + Bx[Iw( 2,0,0)])*(C[Iw( 0,0,0)] + C[Iw( 2,0,0)]) + 
				a2*0.125*(A[Iw(-1,0,0)] + A[Iw( 1,0,0)])* (Bx[Iw(-1,0,0)] + Bx[Iw( 1,0,0)])*(C[Iw(-1,0,0)] + C[Iw( 1,0,0)]) + 
				a3*0.125*(A[Iw( 0,0,0)] + A[Iw( 3,0,0)])* (Bx[Iw( 0,0,0)] + Bx[Iw( 3,0,0)])*(C[Iw( 0,0,0)] + C[Iw( 3,0,0)]) + 
				a3*0.125*(A[Iw(-1,0,0)] + A[Iw( 2,0,0)])* (Bx[Iw(-1,0,0)] + Bx[Iw( 2,0,0)])*(C[Iw(-1,0,0)] + C[Iw( 2,0,0)]) + 
				a3*0.125*(A[Iw(-2,0,0)] + A[Iw( 1,0,0)])* (Bx[Iw(-2,0,0)] + Bx[Iw( 1,0,0)])*(C[Iw(-2,0,0)] + C[Iw( 1,0,0)])  
				) 
				- 
				( 
				a1*0.125*(A[Iw(-1,0,0)] + A[Iw( 0,0,0)])*(Bx[Iw(-1,0,0)] + Bx[Iw( 0,0,0)])*(C[Iw(-1,0,0)] + C[Iw( 0,0,0)]) + 
				a2*0.125*(A[Iw(-1,0,0)] + A[Iw( 1,0,0)])*(Bx[Iw(-1,0,0)] + Bx[Iw( 1,0,0)])*(C[Iw(-1,0,0)] + C[Iw( 1,0,0)]) + 
				a2*0.125*(A[Iw(-2,0,0)] + A[Iw( 0,0,0)])*(Bx[Iw(-2,0,0)] + Bx[Iw( 0,0,0)])*(C[Iw(-2,0,0)] + C[Iw( 0,0,0)]) + 
				a3*0.125*(A[Iw(-1,0,0)] + A[Iw( 2,0,0)])*(Bx[Iw(-1,0,0)] + Bx[Iw( 2,0,0)])*(C[Iw(-1,0,0)] + C[Iw( 2,0,0)]) + 
				a3*0.125*(A[Iw(-2,0,0)] + A[Iw( 1,0,0)])*(Bx[Iw(-2,0,0)] + Bx[Iw( 1,0,0)])*(C[Iw(-2,0,0)] + C[Iw( 1,0,0)]) + 
				a3*0.125*(A[Iw(-3,0,0)] + A[Iw( 0,0,0)])*(Bx[Iw(-3,0,0)] + Bx[Iw( 0,0,0)])*(C[Iw(-3,0,0)] + C[Iw( 0,0,0)]) 
				)
				+
				( 
				a1*0.125*(A[Iw(0, 0,0)] + A[Iw(0, 1,0)])* (By[Iw(0, 0,0)] + By[Iw(0, 1,0)])*(C[Iw(0, 0,0)] + C[Iw(0, 1,0)]) + 
				a2*0.125*(A[Iw(0, 0,0)] + A[Iw(0, 2,0)])* (By[Iw(0, 0,0)] + By[Iw(0, 2,0)])*(C[Iw(0, 0,0)] + C[Iw(0, 2,0)]) + 
				a2*0.125*(A[Iw(0,-1,0)] + A[Iw(0, 1,0)])* (By[Iw(0,-1,0)] + By[Iw(0, 1,0)])*(C[Iw(0,-1,0)] + C[Iw(0, 1,0)]) + 
				a3*0.125*(A[Iw(0, 0,0)] + A[Iw(0, 3,0)])* (By[Iw(0, 0,0)] + By[Iw(0, 3,0)])*(C[Iw(0, 0,0)] + C[Iw(0, 3,0)]) + 
				a3*0.125*(A[Iw(0,-1,0)] + A[Iw(0, 2,0)])* (By[Iw(0,-1,0)] + By[Iw(0, 2,0)])*(C[Iw(0,-1,0)] + C[Iw(0, 2,0)]) + 
				a3*0.125*(A[Iw(0,-2,0)] + A[Iw(0, 1,0)])* (By[Iw(0,-2,0)] + By[Iw(0, 1,0)])*(C[Iw(0,-2,0)] + C[Iw(0, 1,0)])  
				) 
				- 
				( 
				a1*0.125*(A[Iw(0,-1,0)] + A[Iw(0, 0,0)])*(By[Iw(0,-1,0)] + By[Iw(0, 0,0)])*(C[Iw(0,-1,0)] + C[Iw(0, 0,0)]) + 
				a2*0.125*(A[Iw(0,-1,0)] + A[Iw(0, 1,0)])*(By[Iw(0,-1,0)] + By[Iw(0, 1,0)])*(C[Iw(0,-1,0)] + C[Iw(0, 1,0)]) + 
				a2*0.125*(A[Iw(0,-2,0)] + A[Iw(0, 0,0)])*(By[Iw(0,-2,0)] + By[Iw(0, 0,0)])*(C[Iw(0,-2,0)] + C[Iw(0, 0,0)]) + 
				a3*0.125*(A[Iw(0,-1,0)] + A[Iw(0, 2,0)])*(By[Iw(0,-1,0)] + By[Iw(0, 2,0)])*(C[Iw(0,-1,0)] + C[Iw(0, 2,0)]) + 
				a3*0.125*(A[Iw(0,-2,0)] + A[Iw(0, 1,0)])*(By[Iw(0,-2,0)] + By[Iw(0, 1,0)])*(C[Iw(0,-2,0)] + C[Iw(0, 1,0)]) + 
				a3*0.125*(A[Iw(0,-3,0)] + A[Iw(0, 0,0)])*(By[Iw(0,-3,0)] + By[Iw(0, 0,0)])*(C[Iw(0,-3,0)] + C[Iw(0, 0,0)]) 
				)
				+
				( 
				a1*0.125*(A[Iw(0,0, 0)] + A[Iw(0,0, 1)])* (Bz[Iw(0,0, 0)] + Bz[Iw(0,0, 1)])*(C[Iw(0,0, 0)] + C[Iw(0,0, 1)]) + 
				a2*0.125*(A[Iw(0,0, 0)] + A[Iw(0,0, 2)])* (Bz[Iw(0,0, 0)] + Bz[Iw(0,0, 2)])*(C[Iw(0,0, 0)] + C[Iw(0,0, 2)]) + 
				a2*0.125*(A[Iw(0,0,-1)] + A[Iw(0,0, 1)])* (Bz[Iw(0,0,-1)] + Bz[Iw(0,0, 1)])*(C[Iw(0,0,-1)] + C[Iw(0,0, 1)]) + 
				a3*0.125*(A[Iw(0,0, 0)] + A[Iw(0,0, 3)])* (Bz[Iw(0,0, 0)] + Bz[Iw(0,0, 3)])*(C[Iw(0,0, 0)] + C[Iw(0,0, 3)]) + 
				a3*0.125*(A[Iw(0,0,-1)] + A[Iw(0,0, 2)])* (Bz[Iw(0,0,-1)] + Bz[Iw(0,0, 2)])*(C[Iw(0,0,-1)] + C[Iw(0,0, 2)]) + 
				a3*0.125*(A[Iw(0,0,-2)] + A[Iw(0,0, 1)])* (Bz[Iw(0,0,-2)] + Bz[Iw(0,0, 1)])*(C[Iw(0,0,-2)] + C[Iw(0,0, 1)])  
				) 
				- 
				( 
				a1*0.125*(A[Iw(0,0,-1)] + A[Iw(0,0, 0)])*(Bz[Iw(0,0,-1)] + Bz[Iw(0,0, 0)])*(C[Iw(0,0,-1)] + C[Iw(0,0, 0)]) + 
				a2*0.125*(A[Iw(0,0,-1)] + A[Iw(0,0, 1)])*(Bz[Iw(0,0,-1)] + Bz[Iw(0,0, 1)])*(C[Iw(0,0,-1)] + C[Iw(0,0, 1)]) + 
				a2*0.125*(A[Iw(0,0,-2)] + A[Iw(0,0, 0)])*(Bz[Iw(0,0,-2)] + Bz[Iw(0,0, 0)])*(C[Iw(0,0,-2)] + C[Iw(0,0, 0)]) + 
				a3*0.125*(A[Iw(0,0,-1)] + A[Iw(0,0, 2)])*(Bz[Iw(0,0,-1)] + Bz[Iw(0,0, 2)])*(C[Iw(0,0,-1)] + C[Iw(0,0, 2)]) + 
				a3*0.125*(A[Iw(0,0,-2)] + A[Iw(0,0, 1)])*(Bz[Iw(0,0,-2)] + Bz[Iw(0,0, 1)])*(C[Iw(0,0,-2)] + C[Iw(0,0, 1)]) + 
				a3*0.125*(A[Iw(0,0,-3)] + A[Iw(0,0, 0)])*(Bz[Iw(0,0,-3)] + Bz[Iw(0,0, 0)])*(C[Iw(0,0,-3)] + C[Iw(0,0, 0)]) 
				) 
			);
	return D;
}


























